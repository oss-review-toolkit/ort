# Copyright (C) 2024 The ORT Project Authors (see <https://github.com/oss-review-toolkit/ort/blob/main/NOTICE>)
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# SPDX-License-Identifier: Apache-2.0
# License-Filename: LICENSE

# Disable sanity checks to allow BitBake to run as root which is required in some Docker scenarios.
INHERIT:remove = "sanity"

# Work around wget2, as shipping with Fedora 40, to not support `--passive-ftp`, see
# https://github.com/openembedded/bitbake/commit/f10e630fd7561746d835a4378e8777e78f56e44a.
FETCHCMD_wget = "/usr/bin/env wget -t 2 -T 30"

# See https://docs.yoctoproject.org/ref-manual/variables.html#term-S for a general list of supported variables.
INHERIT += "create-spdx"

# This option allows to add to SPDX output compressed archives of the files in the generated target packages.
# Such archives are available in tmp/deploy/spdx/MACHINE/packages/packagename.tar.zst under the Build Directory.
SPDX_ARCHIVE_PACKAGED = "1"

# This option allows to add to SPDX output compressed archives of the sources for packages installed on the target. It
# currently only works when SPDX_INCLUDE_SOURCES is set.
# Such source archives are available in tmp/deploy/spdx/MACHINE/recipes/recipe-packagename.tar.zst under the Build
# Directory.
SPDX_ARCHIVE_SOURCES = "1"

# This option allows to add a description of the source files used to build the host tools and the target packages, to
# the spdx.json files in tmp/deploy/spdx/MACHINE/recipes/ under the Build Directory. As a consequence, the spdx.json
# files under the by-namespace and packages subdirectories in tmp/deploy/spdx/MACHINE are also modified to include
# references to such source file descriptions.
SPDX_INCLUDE_SOURCES = "1"

# This option could be used in order to change the prefix of spdxDocument and the prefix of documentNamespace. Older
# BitBake versions set this by default to "http://spdx.org/spdxdoc", which is wrong (see
# https://bugzilla.yoctoproject.org/show_bug.cgi?id=15398), so fix it up here.
SPDX_NAMESPACE_PREFIX = "https://spdx.org/spdxdocs"

# This option makes the SPDX output more human-readable, using indentation and newlines, instead of the default output in
# a single line. The generated SPDX files are approximately 20% bigger, but this option is recommended if you want to
# inspect the SPDX output files with a text editor.
SPDX_PRETTY = "1"
