/*
 * Copyright (C) 2025 The ORT Project Authors (see <https://github.com/oss-review-toolkit/ort/blob/main/NOTICE>)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 * License-Filename: LICENSE
 */

import {
    useState
} from 'react';

import {
    Descriptions,
    List
} from 'antd';

const { Item } = Descriptions;

// Generates the HTML to display references for a vulnerability as a list
const VulnerabilityReferencesList = ({ references = [] }) => {
    // State variable for displaying list in various pages
    const [pagination, setPagination] = useState({ current: 1, pageSize: 5 });

    // Handle for list pagination changes
    const handlePaginationChange = (page, pageSize) => {
        setPagination({ current: page, pageSize });
    };

    return (
        <List
            dataSource={references}
            size='small'
            pagination={{
                align: 'end',
                current: pagination.current,
                hideOnSinglePage: true,
                onChange: handlePaginationChange,
                pageSize: pagination.pageSize,
                pageSizeOptions: ['5', '10', '20'],
                position: 'bottom',
                showSizeChanger: true
            }}
            renderItem={(reference) => {
                const {
                    url,
                    scoringSystem,
                    severity,
                    score,
                    vector
                } = reference;

                return (
                    <List.Item>
                        <Descriptions
                            className="ort-vulnerability-references-list"
                            column={{ xs: 1, sm: 1, md: 2, xl: 3 }}
                            size="small"
                        >
                            {
                                !!scoringSystem
                                && (
                                    <Item
                                        key="ort-vulnerability-scoring-system"
                                        span="2"
                                        label="Scoring system"
                                    >
                                        {scoringSystem}
                                    </Item>
                                )
                            }
                            {
                                !!score
                                && (
                                    <Item
                                        key="ort-vulnerability-score"
                                        label="Score"
                                    >
                                        {score}
                                    </Item>
                                )
                            }
                            {
                                !!severity
                                && (
                                    <Item
                                        key="ort-vulnerability-severity"
                                        label="Severity"
                                    >
                                        {severity}
                                    </Item>
                                )
                            }
                            {
                                !!vector
                                && (
                                    <Item
                                        key="ort-vulnerability-vector"
                                        label="Vector"
                                    >
                                        {vector}
                                    </Item>
                                )
                            }
                            {
                                !!url
                                && (
                                    <Item
                                        key="ort-vulnerbility-url"
                                        label="URL"
                                    >
                                        <a
                                            href={url}
                                            rel="noopener noreferrer"
                                            target="_blank"
                                        >
                                            {url}
                                        </a>
                                    </Item>
                                )
                            }
                        </Descriptions>
                    </List.Item>
                );
            }}
        />
    )
};

export default VulnerabilityReferencesList;
